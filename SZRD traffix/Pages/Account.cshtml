@page
@model SZRD_traffix.AccountModel
@{
    ViewData["Title"] = "Moje Konto - SZRD traffix";
}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
    :root {
        --szrd-orange: #e67e22;
        --szrd-dark: #2c3e50;
        --szrd-darker: #1a1a1a;
    }

    body {
        background-color: var(--szrd-dark);
        color: white;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .account-container {
        padding: 40px;
        max-width: 800px;
        margin: 0 auto;
    }

    .profile-card {
        background: #34495e;
        border-radius: 8px;
        padding: 30px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        margin-bottom: 20px;
    }

    .section-title {
        border-bottom: 2px solid var(--szrd-orange);
        padding-bottom: 10px;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .info-row {
        display: flex;
        margin-bottom: 15px;
        border-bottom: 1px solid rgba(255,255,255,0.05);
        padding-bottom: 10px;
    }

    .info-label {
        width: 150px;
        color: #bdc3c7;
        font-weight: bold;
    }

    .info-value {
        color: white;
    }

    .form-group {
        margin-bottom: 20px;
    }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #bdc3c7;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border-radius: 4px;
            border: 1px solid #2c3e50;
            background: #1a1a1a;
            color: white;
            box-sizing: border-box;
        }

    .btn-save-password {
        background: var(--szrd-orange);
        color: white;
        border: none;
        padding: 12px 25px;
        border-radius: 4px;
        font-weight: bold;
        cursor: pointer;
        transition: 0.3s;
    }

        .btn-save-password:hover {
            background: #d35400;
        }

    .alert {
        padding: 15px;
        border-radius: 4px;
        margin-bottom: 20px;
    }

    .alert-success {
        background: #27ae60;
        color: white;
    }

    .alert-danger {
        background: #c0392b;
        color: white;
    }
</style>
<div class="account-container">
    <div class="page-header" style="margin-bottom: 30px;">
        <h1>Ustawienia Konta</h1>
    </div>

    @if (!string.IsNullOrEmpty(Model.StatusMessage))
    {
        var isError = Model.StatusMessage.StartsWith("Error");
        <div class="alert @(isError ? "alert-danger" : "alert-success")">
            <i class="fas @(isError ? "fa-exclamation-circle" : "fa-check-circle")"></i>
            @Model.StatusMessage.Replace("Error: ", "").Replace("Success: ", "")
        </div>
    }

    @if (Users.CurrentUser != null)
    {
        <div class="profile-card">
            <h3 class="section-title">Twoje Dane</h3>
            <div class="info-row">
                <div class="info-label">Imię i Nazwisko:</div>
                <div class="info-value">@Users.CurrentUser.nazwa</div>
            </div>
            <div class="info-row">
                <div class="info-label">Adres Email:</div>
                <div class="info-value">@Users.CurrentUser.email</div>
            </div>
            <div class="info-row">
                <div class="info-label">Rola w SZRD:</div>
                <div class="info-value">
                    <span style="color: var(--szrd-orange); font-weight: bold;">@Users.CurrentUser.role</span>
                </div>
            </div>
        </div>

        <div class="profile-card">
            <h3 class="section-title">Bezpieczeństwo</h3>
            <form method="post" asp-page-handler="ChangePassword">
                <div class="form-group">
                    <label>Obecne hasło</label>
                    <input type="password" name="oldPassword" required />
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label>Nowe hasło</label>
                        <input type="password" name="newPassword" required />
                    </div>
                    <div class="form-group">
                        <label>Powtórz nowe hasło</label>
                        <input type="password" name="confirmPassword" required />
                    </div>
                </div>

                <button type="submit" class="btn-save-password">
                    <i class="fas fa-key"></i> Aktualizuj Hasło
                </button>
            </form>
        </div>
    }
</div>
